<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calabritto Emiliano â€” Prenota un Appuntamento</title>
  <meta name="description" content="Prenota il tuo appuntamento con Calabritto Emiliano. Fototessera, consulenze matrimonio, 18esimi, comunioni e altro.">
  <meta property="og:title" content="Calabritto Emiliano â€” Fotografia d'Autore">
  <meta property="og:description" content="Prenota il tuo appuntamento online.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœ¦</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{--font-display:'Playfair Display',Georgia,serif;--font-body:'DM Sans','Helvetica Neue',Arial,sans-serif;--gold:#c8a45e;--dark:#1a1a1a;--gray:#888;--light-border:#eae7e1;--light-bg:#faf9f7;--wa:#25D366;--wa-dark:#128C7E}
    body{font-family:var(--font-body);color:var(--dark);background:linear-gradient(180deg,#fdfcfa 0%,#f5f2ed 100%);min-height:100vh}
    .app{display:flex;flex-direction:column;align-items:center;padding:40px 20px;min-height:100vh}
    .header{text-align:center;margin-bottom:32px}
    .logo-mark{font-size:28px;color:var(--gold);margin-bottom:8px;letter-spacing:4px}
    .brand{font-family:var(--font-display);font-size:32px;font-weight:600;letter-spacing:1px}
    .tagline{font-family:var(--font-display);font-style:italic;font-size:14px;color:#999;margin-top:4px;letter-spacing:2px}
    .progress{display:flex;align-items:center;justify-content:center;margin-bottom:36px;flex-wrap:wrap;gap:4px}
    .progress-step{display:flex;align-items:center;gap:8px}
    .progress-dot{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#e0dcd5;transition:all .3s;font-size:10px;color:#fff}
    .progress-dot.active{background:var(--dark);transform:scale(1.3)}.progress-dot.done{background:var(--dark)}
    .progress-label{font-size:12px;letter-spacing:.5px;text-transform:uppercase;color:#aaa;transition:all .3s}
    .progress-label.active{color:var(--dark);font-weight:600}.progress-label.done{color:var(--dark)}
    .progress-line{width:40px;height:2px;margin:0 8px;background:#e0dcd5;transition:background .3s}.progress-line.done{background:var(--dark)}
    .content{width:100%;max-width:720px;transition:opacity .4s,transform .4s}.content.fade-out{opacity:0;transform:translateY(12px)}
    .step-title{font-family:var(--font-display);font-size:26px;font-weight:600;margin-bottom:6px}
    .step-desc{font-size:14px;color:var(--gray);margin-bottom:28px}
    .service-list{display:flex;flex-direction:column;gap:10px;margin-bottom:28px}
    .service-card{display:flex;align-items:center;gap:14px;padding:16px 20px;border:1.5px solid var(--light-border);border-radius:12px;cursor:pointer;transition:all .2s;background:#fff;text-align:left}
    .service-card:hover{border-color:#ccc}.service-card.selected{border-color:var(--dark);background:var(--light-bg)}
    .service-icon{font-size:22px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:#f5f2ed;border-radius:8px;flex-shrink:0}
    .service-name{flex:1;font-size:15px;font-weight:500}
    .service-price{font-size:15px;font-weight:600;color:var(--gold)}.service-price.muted{color:#999}
    .custom-desc-box{margin-bottom:24px}.custom-desc-box label{display:block;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:var(--gray);margin-bottom:6px}
    .custom-desc-box textarea{width:100%;padding:12px 14px;border:1.5px solid #e0dcd5;border-radius:10px;font-size:14px;font-family:var(--font-body);outline:none;background:#fff;min-height:80px;resize:vertical}
    .custom-desc-box textarea:focus{border-color:var(--gold)}
    .datetime-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px}
    .cal-box,.time-box{background:#fff;border-radius:14px;padding:20px;border:1px solid var(--light-border)}
    .cal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    .cal-month{font-family:var(--font-display);font-size:16px;font-weight:600}
    .cal-nav{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;color:var(--dark)}.cal-nav:disabled{opacity:.3;cursor:default}
    .day-labels{display:grid;grid-template-columns:repeat(7,1fr);justify-items:center;margin-bottom:4px}
    .day-label{font-size:11px;color:#aaa;text-transform:uppercase;letter-spacing:.5px;font-weight:500}
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);justify-items:center;row-gap:2px}
    .cal-day{width:44px;height:44px;border-radius:50%;border:none;background:transparent;font-family:var(--font-body);font-size:14px;cursor:pointer;position:relative;transition:all .2s;color:var(--dark)}
    .cal-day:disabled{color:#ccc;cursor:default}.cal-day.selected{background:var(--dark);color:#fff;font-weight:600}
    .cal-day.today:not(.selected){background:rgba(26,26,26,.08)}
    .cal-day .today-dot{position:absolute;bottom:4px;left:50%;transform:translateX(-50%);width:4px;height:4px;border-radius:50%;background:var(--gold)}
    .time-box{display:flex;flex-direction:column}
    .time-header{font-family:var(--font-display);font-size:14px;font-weight:600;margin-bottom:14px}
    .time-list{display:flex;flex-direction:column;gap:10px}
    .time-slot{padding:14px 16px;border-radius:10px;border:1.5px solid var(--light-border);background:#fff;cursor:pointer;font-size:15px;font-weight:500;font-family:var(--font-body);transition:all .15s;text-align:center}
    .time-slot:hover{border-color:#ccc}.time-slot.selected{background:var(--dark);color:#fff;border-color:var(--dark)}
    .time-placeholder{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:200px}
    .time-placeholder span{font-size:32px;opacity:.2}.time-placeholder p{color:#aaa;margin-top:12px;font-size:14px}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
    .field{display:flex;flex-direction:column;gap:6px}
    .field label{font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:var(--gray)}
    .field input,.field textarea{padding:12px 14px;border:1.5px solid #e0dcd5;border-radius:10px;font-size:14px;font-family:var(--font-body);outline:none;background:#fff}
    .field input:focus,.field textarea:focus{border-color:var(--gold)}.field textarea{min-height:80px;resize:vertical}
    .review-strip{display:flex;align-items:center;gap:10px;padding:14px 18px;background:#fff;border:1px solid var(--light-border);border-radius:10px;font-size:13px;font-weight:500;margin-bottom:24px;flex-wrap:wrap}
    .review-strip .dot{color:#ccc}.review-strip .price{color:var(--gold);font-weight:600}
    .wa-notice{display:flex;align-items:center;gap:10px;padding:12px 16px;background:rgba(37,211,102,.08);border:1px solid rgba(37,211,102,.2);border-radius:10px;font-size:13px;color:#666;margin-bottom:20px;line-height:1.5}
    .btn-row{display:flex;gap:12px;margin-top:8px}
    .btn-primary{display:block;width:100%;padding:14px 24px;background:var(--dark);color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:600;letter-spacing:.5px;cursor:pointer;transition:opacity .2s;font-family:var(--font-body)}
    .btn-primary:disabled{opacity:.4;cursor:default}
    .btn-back{padding:14px 24px;background:transparent;color:var(--gray);border:1.5px solid #e0dcd5;border-radius:10px;font-size:14px;font-weight:500;cursor:pointer;flex-shrink:0;font-family:var(--font-body)}
    .btn-link{background:none;border:none;color:var(--gold);font-size:14px;font-weight:600;cursor:pointer;letter-spacing:.5px;font-family:var(--font-body);margin-top:20px}
    .btn-whatsapp{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;padding:16px 24px;background:var(--wa);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;font-family:var(--font-body);transition:background .2s;letter-spacing:.3px;margin-bottom:12px}
    .btn-whatsapp:hover{background:var(--wa-dark)}
    .btn-whatsapp svg{width:22px;height:22px;fill:#fff}
    .confirm-card{text-align:center;max-width:480px;background:#fff;border-radius:20px;padding:48px 36px;border:1px solid var(--light-border);box-shadow:0 12px 40px rgba(0,0,0,.06);animation:slideUp .6s ease forwards}
    .confirm-title{font-family:var(--font-display);font-size:28px;font-weight:600;margin-bottom:8px}
    .confirm-sub{font-size:14px;color:var(--gray);margin-bottom:28px}
    .summary-box{text-align:left;background:var(--light-bg);border-radius:12px;padding:4px 20px;margin-bottom:24px}
    .summary-row{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #eee}.summary-row:last-child{border-bottom:none}
    .sum-label{font-size:13px;color:var(--gray)}.sum-value{font-size:14px;font-weight:500;text-align:right;max-width:60%}.sum-value.gold{color:var(--gold);font-weight:700}
    .paypal-section{margin-top:20px;padding:20px 24px;background:var(--light-bg);border-radius:14px;text-align:center}
    .paypal-title{font-weight:600;font-size:15px;margin-bottom:4px}
    .paypal-subtitle{font-size:13px;color:var(--gray);margin-bottom:20px}
    .paypal-btns{max-width:300px;margin:0 auto}
    .divider-row{display:flex;align-items:center;gap:12px;margin:16px 0}
    .divider-line{flex:1;height:1px;background:#e0dcd5}
    .divider-text{font-size:12px;color:#aaa;text-transform:uppercase;letter-spacing:1px}
    .btn-skip{background:none;border:1.5px solid #e0dcd5;border-radius:10px;padding:12px 24px;font-size:14px;font-weight:500;color:#666;cursor:pointer;font-family:var(--font-body);width:100%;max-width:300px}
    .paid-box{text-align:center;padding:24px;background:#e8f5e9;border-radius:14px;margin-top:20px;color:#2e7d32}
    .footer{margin-top:48px;display:flex;gap:12px;font-size:12px;color:#aaa;letter-spacing:.5px}
    @keyframes slideUp{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}
    @media(max-width:600px){
      .datetime-grid{grid-template-columns:1fr}.form-grid{grid-template-columns:1fr}
      .brand{font-size:26px}.step-title{font-size:22px}.progress-label{font-size:10px}
      .progress-line{width:24px}.confirm-card{padding:32px 20px}
      .btn-row{flex-direction:column}.btn-back{width:100%;text-align:center}
    }
    .hidden{display:none!important}
  </style>
</head>
<body>
<div class="app">
  <div id="booking-view">
    <header class="header">
      <div class="logo-mark">âœ¦</div>
      <h1 class="brand">Calabritto Emiliano</h1>
      <p class="tagline">Fotografia d'Autore</p>
    </header>
    <div class="progress" id="progress"></div>
    <div class="content" id="step-content"></div>
    <footer class="footer">
      <span>Â© 2026 Calabritto Emiliano</span>
      <span style="color:#ccc">Â·</span>
      <span>info@calabrittoemiliano.com</span>
    </footer>
  </div>
  <div id="confirm-view" class="hidden"></div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš™ï¸  CONFIGURAZIONE â€” MODIFICA SOLO QUI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const CONFIG = {
  // Numero WhatsApp del fotografo (prefisso internazionale SENZA +)
  // Esempio: 393331234567  â†’  +39 333 123 4567
  whatsappNumber: "3925312405",

  // PayPal Client ID (opzionale) â€” lascia "" se non vuoi PayPal
  paypalClientId: "",
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“‹  SERVIZI â€” modifica nomi, prezzi, icone
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SERVICES = [
  { id: "fototessera", name: "Fototessera",           price: 5,   icon: "â—" },
  { id: "matrimonio",  name: "Consulenza Matrimonio",  price: null, icon: "â—‘" },
  { id: "18esimi",     name: "Consulenza 18esimi",     price: null, icon: "â—’" },
  { id: "comunioni",   name: "Consulenza Comunioni",   price: null, icon: "â—“" },
  { id: "altro",       name: "Altro",                  price: null, icon: "â—”" },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ•  ORARI DISPONIBILI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TIME_SLOTS = ["17:00", "17:30", "18:00", "18:30"];


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DA QUI IN GIÃ™ NON TOCCARE (a meno che non sai cosa fai)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const MONTHS=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];
const DAYS_SHORT=["Dom","Lun","Mar","Mer","Gio","Ven","Sab"];
const WA_SVG=`<svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>`;

let state={step:0,serviceId:null,customDesc:"",curMonth:new Date().getMonth(),curYear:new Date().getFullYear(),selectedDay:null,selectedTime:null,client:{name:"",email:"",phone:"",notes:""}};
const today=new Date();today.setHours(0,0,0,0);
function getSvc(){return SERVICES.find(s=>s.id===state.serviceId)}
function priceLabel(p){return p==null?"Su preventivo":p===0?"Gratuito":`â‚¬${p}`}
function formatDate(){if(!state.selectedDay)return"";const d=new Date(state.curYear,state.curMonth,state.selectedDay);return`${DAYS_SHORT[d.getDay()]} ${state.selectedDay} ${MONTHS[state.curMonth]} ${state.curYear}`}

function buildWhatsAppUrl(){
  const s=getSvc(),c=state.client;
  let m=`âœ¦ *NUOVA PRENOTAZIONE*\n\nğŸ‘¤ *Cliente:* ${c.name}\n`;
  if(c.phone)m+=`ğŸ“ *Telefono:* ${c.phone}\n`;
  if(c.email)m+=`ğŸ“§ *Email:* ${c.email}\n`;
  m+=`\nğŸ“¸ *Servizio:* ${s.name}\nğŸ“… *Data:* ${formatDate()}\nğŸ• *Orario:* ${state.selectedTime}\nğŸ’° *Prezzo:* ${priceLabel(s.price)}\n`;
  if(state.serviceId==="altro"&&state.customDesc)m+=`\nğŸ“ *Richiesta:* ${state.customDesc}\n`;
  if(c.notes)m+=`\nğŸ’¬ *Note:* ${c.notes}\n`;
  return`https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(m)}`;
}

// â”€â”€ Render â”€â”€
function render(){renderProgress();const el=document.getElementById("step-content");el.classList.add("fade-out");setTimeout(()=>{if(state.step===0)renderStep0(el);else if(state.step===1)renderStep1(el);else renderStep2(el);el.classList.remove("fade-out")},50)}

function renderProgress(){const L=["Servizio","Data e Ora","Dettagli"];let h="";L.forEach((l,i)=>{h+=`<div class="progress-step"><div class="progress-dot ${i<state.step?"done":i===state.step?"active":""}">${i<state.step?"âœ“":""}</div><span class="progress-label ${i<state.step?"done":i===state.step?"active":""}">${l}</span>${i<2?`<div class="progress-line ${i<state.step?"done":""}"></div>`:""}</div>`});document.getElementById("progress").innerHTML=h}

// â”€â”€ Step 0: Servizio â”€â”€
function renderStep0(el){
  let cards=SERVICES.map(s=>`<div class="service-card ${state.serviceId===s.id?"selected":""}" onclick="selectService('${s.id}')"><span class="service-icon">${s.icon}</span><span class="service-name">${s.name}</span><span class="service-price ${s.price==null?"muted":""}">${priceLabel(s.price)}</span></div>`).join("");
  let cb="";if(state.serviceId==="altro")cb=`<div class="custom-desc-box"><label>Descrivi cosa ti serve *</label><textarea id="custom-desc" placeholder="Descrivi brevemente di cosa hai bisognoâ€¦" oninput="state.customDesc=this.value;updBtn0()">${state.customDesc}</textarea></div>`;
  const ok=state.serviceId&&(state.serviceId!=="altro"||state.customDesc.trim());
  el.innerHTML=`<h2 class="step-title">Scegli il Servizio</h2><p class="step-desc">Seleziona il tipo di servizio di cui hai bisogno.</p><div class="service-list">${cards}</div>${cb}<button class="btn-primary" id="b0" ${ok?"":"disabled"} onclick="goStep(1)">Continua</button>`;
}
function selectService(id){state.serviceId=id;if(id!=="altro")state.customDesc="";render()}
function updBtn0(){const b=document.getElementById("b0");if(b)b.disabled=!(state.serviceId&&(state.serviceId!=="altro"||state.customDesc.trim()))}

// â”€â”€ Step 1: Data e Ora â”€â”€
function renderStep1(el){
  const dim=new Date(state.curYear,state.curMonth+1,0).getDate(),fd=new Date(state.curYear,state.curMonth,1).getDay();
  const canPrev=state.curYear>today.getFullYear()||(state.curYear===today.getFullYear()&&state.curMonth>today.getMonth());
  let dc="";for(let i=0;i<fd;i++)dc+="<div></div>";
  for(let d=1;d<=dim;d++){const dt=new Date(state.curYear,state.curMonth,d),past=dt<today,sun=dt.getDay()===0,dis=past||sun,sel=state.selectedDay===d,td=state.curYear===today.getFullYear()&&state.curMonth===today.getMonth()&&d===today.getDate();
    dc+=`<button class="cal-day ${sel?"selected":""} ${td&&!sel?"today":""}" ${dis?"disabled":""} onclick="selDay(${d})">${d}${td&&!sel?'<span class="today-dot"></span>':""}</button>`}
  let th;
  if(state.selectedDay){th=`<p class="time-header">${formatDate()}</p><div class="time-list">${TIME_SLOTS.map(t=>`<button class="time-slot ${state.selectedTime===t?"selected":""}" onclick="selTime('${t}')">${t}</button>`).join("")}</div>`}
  else th=`<div class="time-placeholder"><span>â—·</span><p>Seleziona una data</p></div>`;
  el.innerHTML=`<h2 class="step-title">Scegli Data e Orario</h2><p class="step-desc">Disponibile dal lunedÃ¬ al sabato, dalle 17:00 alle 19:00.</p><div class="datetime-grid"><div class="cal-box"><div class="cal-header"><button class="cal-nav" ${canPrev?"":"disabled"} onclick="prevMo()">â†</button><span class="cal-month">${MONTHS[state.curMonth]} ${state.curYear}</span><button class="cal-nav" onclick="nextMo()">â†’</button></div><div class="day-labels">${DAYS_SHORT.map(d=>`<div class="day-label">${d}</div>`).join("")}</div><div class="cal-grid">${dc}</div></div><div class="time-box">${th}</div></div><div class="btn-row"><button class="btn-back" onclick="goStep(0)">â† Indietro</button><button class="btn-primary" ${state.selectedDay&&state.selectedTime?"":"disabled"} onclick="goStep(2)">Continua</button></div>`;
}
function selDay(d){state.selectedDay=d;state.selectedTime=null;renderStep1(document.getElementById("step-content"))}
function selTime(t){state.selectedTime=t;renderStep1(document.getElementById("step-content"))}
function prevMo(){if(state.curMonth===0){state.curMonth=11;state.curYear--}else state.curMonth--;state.selectedDay=null;state.selectedTime=null;renderStep1(document.getElementById("step-content"))}
function nextMo(){if(state.curMonth===11){state.curMonth=0;state.curYear++}else state.curMonth++;state.selectedDay=null;state.selectedTime=null;renderStep1(document.getElementById("step-content"))}

// â”€â”€ Step 2: Dettagli â”€â”€
function renderStep2(el){
  const s=getSvc(),c=state.client;
  el.innerHTML=`<h2 class="step-title">I Tuoi Dati</h2><p class="step-desc">Inserisci i tuoi dati di contatto.</p>
    <div class="review-strip"><span>${s.name}</span><span class="dot">Â·</span><span>${formatDate()}</span><span class="dot">Â·</span><span>${state.selectedTime}</span>${s.price>0?`<span class="dot">Â·</span><span class="price">â‚¬${s.price}</span>`:""}</div>
    <div class="form-grid">
      <div class="field"><label>Nome e Cognome *</label><input id="fn" value="${c.name}" oninput="updCl()" placeholder="Mario Rossi"></div>
      <div class="field"><label>Email</label><input id="fe" type="email" value="${c.email}" oninput="updCl()" placeholder="mario@esempio.com"></div>
      <div class="field"><label>Telefono *</label><input id="fp" type="tel" value="${c.phone}" oninput="updCl()" placeholder="+39 333 000 0000"></div>
      <div class="field"><label>Note aggiuntive</label><textarea id="fno" oninput="updCl()" placeholder="Informazioni utiliâ€¦">${c.notes}</textarea></div>
    </div>
    <div class="wa-notice"><span style="font-size:18px">ğŸ’¬</span><span>Dopo la conferma si aprirÃ  WhatsApp con il riepilogo da inviare al fotografo</span></div>
    <div class="btn-row"><button class="btn-back" onclick="goStep(1)">â† Indietro</button>
      <button class="btn-primary" id="cb" ${c.name&&c.phone?"":"disabled"} onclick="handleConfirm()">${s.price>0?`Conferma â€” â‚¬${s.price}`:"Conferma Prenotazione"}</button></div>`;
}
function updCl(){state.client.name=document.getElementById("fn").value;state.client.email=document.getElementById("fe").value;state.client.phone=document.getElementById("fp").value;state.client.notes=document.getElementById("fno").value;const b=document.getElementById("cb");if(b)b.disabled=!(state.client.name&&state.client.phone)}
function goStep(n){state.step=n;render()}

// â”€â”€ Conferma â”€â”€
function handleConfirm(){
  const s=getSvc(),c=state.client;if(!c.name||!c.phone)return;
  document.getElementById("booking-view").classList.add("hidden");
  const cv=document.getElementById("confirm-view");cv.classList.remove("hidden");
  let rows=[["Servizio",s.name],["Data",formatDate()],["Orario",state.selectedTime],["Cliente",c.name],["Telefono",c.phone]];
  if(c.email)rows.push(["Email",c.email]);
  if(state.serviceId==="altro"&&state.customDesc)rows.push(["Richiesta",state.customDesc]);
  if(c.notes)rows.push(["Note",c.notes]);
  let sh=rows.map(([l,v])=>`<div class="summary-row"><span class="sum-label">${l}</span><span class="sum-value">${v}</span></div>`).join("");
  sh+=`<div class="summary-row"><span class="sum-label">Prezzo</span><span class="sum-value gold">${priceLabel(s.price)}</span></div>`;
  cv.innerHTML=`<div class="confirm-card"><div style="font-size:48px;margin-bottom:16px">âœ¦</div>
    <h2 class="confirm-title">Prenotazione Pronta!</h2>
    <p class="confirm-sub">Invia il riepilogo al fotografo tramite WhatsApp per confermare</p>
    <div class="summary-box">${sh}</div>
    <button class="btn-whatsapp" onclick="window.open('${buildWhatsAppUrl()}','_blank')">${WA_SVG} Invia su WhatsApp</button>
    <div id="paypal-area"></div>
    <button class="btn-link" onclick="resetAll()">Prenota un altro appuntamento</button></div>`;
  if(s.price>0&&CONFIG.paypalClientId)loadPayPal(s);
}

// â”€â”€ PayPal â”€â”€
function loadPayPal(s){
  const a=document.getElementById("paypal-area");
  a.innerHTML=`<div class="paypal-section"><p class="paypal-title">Paga ora (opzionale)</p><p class="paypal-subtitle">Puoi pagare con PayPal o pagare in studio</p><div class="paypal-btns" id="pp-btns"></div><div class="divider-row"><div class="divider-line"></div><span class="divider-text">oppure</span><div class="divider-line"></div></div><button class="btn-skip" onclick="document.getElementById('paypal-area').innerHTML=''">PagherÃ² in studio</button></div>`;
  const sc=document.createElement("script");sc.src=`https://www.paypal.com/sdk/js?client-id=${CONFIG.paypalClientId}&currency=EUR`;
  sc.onload=()=>{paypal.Buttons({style:{layout:"vertical",shape:"rect",label:"pay",height:45},createOrder:(d,ac)=>ac.order.create({purchase_units:[{amount:{value:String(s.price),currency_code:"EUR"},description:`${s.name} â€” ${formatDate()} ${state.selectedTime}`}]}),onApprove:async(d,ac)=>{await ac.order.capture();a.innerHTML=`<div class="paid-box"><div style="font-size:28px">âœ“</div><p style="font-weight:600;margin:8px 0 0">Pagamento ricevuto</p><p style="font-size:13px;margin:4px 0 0;color:#2e7d32">Grazie!</p></div>`},onError:()=>{a.querySelector(".paypal-subtitle").textContent="Errore. Riprova o paga in studio.";a.querySelector(".paypal-subtitle").style.color="#c0392b"}}).render("#pp-btns")};
  document.head.appendChild(sc);
}

// â”€â”€ Reset â”€â”€
function resetAll(){state={step:0,serviceId:null,customDesc:"",curMonth:new Date().getMonth(),curYear:new Date().getFullYear(),selectedDay:null,selectedTime:null,client:{name:"",email:"",phone:"",notes:""}};document.getElementById("confirm-view").classList.add("hidden");document.getElementById("booking-view").classList.remove("hidden");render()}

render();
</script>
</body>
</html>
