<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Studio Fotografico Emiliano Calabritto ‚Äî Prenota un Appuntamento</title>
  <meta name="description" content="Prenota il tuo appuntamento con lo Studio Fotografico Emiliano Calabritto a Montecorvino Rovella (SA). Fototessera, consulenze matrimonio, 18esimi, comunioni e altro.">
  <meta property="og:title" content="Studio Fotografico Emiliano Calabritto ‚Äî Fotografia d'Autore">
  <meta property="og:description" content="Prenota il tuo appuntamento online.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ú¶</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{--font-display:'Playfair Display',Georgia,serif;--font-body:'DM Sans','Helvetica Neue',Arial,sans-serif;--gold:#c8a45e;--dark:#1a1a1a;--gray:#888;--light-border:#eae7e1;--light-bg:#faf9f7;--wa:#25D366;--wa-dark:#128C7E}
    body{font-family:var(--font-body);color:var(--dark);background:linear-gradient(180deg,#fdfcfa 0%,#f5f2ed 100%);min-height:100vh;-webkit-text-size-adjust:100%}
    .app{display:flex;flex-direction:column;align-items:center;min-height:100vh}

    /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
    .hero{width:100%;background:var(--dark);text-align:center;padding:56px 20px 48px}
    .hero .logo-mark{font-size:36px;color:var(--gold);margin-bottom:14px;letter-spacing:6px}
    .hero .brand{font-family:var(--font-display);font-size:38px;font-weight:700;color:#fff;letter-spacing:2px;margin-bottom:6px}
    .hero .tagline{font-family:var(--font-display);font-style:italic;font-size:17px;color:rgba(255,255,255,0.6);letter-spacing:2px;margin-bottom:32px}
    .hero .cta-text{font-size:24px;font-weight:600;color:#fff;line-height:1.4;margin-bottom:10px}
    .hero .cta-sub{font-size:17px;color:rgba(255,255,255,0.7);font-weight:400;margin-bottom:32px}
    .hero .scroll-hint{display:inline-flex;align-items:center;gap:8px;padding:14px 32px;background:var(--gold);color:#fff;border-radius:30px;font-size:17px;font-weight:600;letter-spacing:0.5px;cursor:pointer;border:none;font-family:var(--font-body);transition:background .2s}
    .hero .scroll-hint:hover{background:#b8943e}

    /* ‚îÄ‚îÄ GALLERY ‚îÄ‚îÄ */
    .gallery-section{width:100%;padding:44px 0 24px;overflow:hidden}
    .gallery-title{text-align:center;font-family:var(--font-display);font-size:26px;font-weight:600;margin-bottom:8px}
    .gallery-sub{text-align:center;font-size:16px;color:var(--gray);margin-bottom:28px}
    .gallery-track{display:flex;gap:14px;overflow-x:auto;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;padding:0 20px 16px;scrollbar-width:none}
    .gallery-track::-webkit-scrollbar{display:none}
    .gallery-item{flex:0 0 300px;height:220px;border-radius:14px;overflow:hidden;scroll-snap-align:start;position:relative;cursor:pointer;transition:transform .2s}
    .gallery-item:hover{transform:scale(1.02)}
    .gallery-item img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .3s}
    .gallery-item:hover img{transform:scale(1.08)}
    .gallery-hint{text-align:center;margin-top:4px;font-size:14px;color:#bbb;letter-spacing:0.5px}

    /* ‚îÄ‚îÄ LIGHTBOX ‚îÄ‚îÄ */
    .lightbox{position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,0.92);display:none;align-items:center;justify-content:center;opacity:0;transition:opacity .3s}
    .lightbox.open{display:flex;opacity:1}
    .lightbox img{max-width:90vw;max-height:85vh;border-radius:12px;object-fit:contain}
    .lightbox-close{position:absolute;top:20px;right:24px;background:none;border:none;color:#fff;font-size:32px;cursor:pointer;width:44px;height:44px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s}
    .lightbox-close:hover{background:rgba(255,255,255,0.1)}
    .lightbox-nav{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,0.1);border:none;color:#fff;font-size:28px;cursor:pointer;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background .2s}
    .lightbox-nav:hover{background:rgba(255,255,255,0.2)}
    .lightbox-prev{left:16px}.lightbox-next{right:16px}

    /* ‚îÄ‚îÄ MAIN AREA ‚îÄ‚îÄ */
    .main-area{padding:44px 20px;display:flex;flex-direction:column;align-items:center;width:100%}
    .progress{display:flex;align-items:center;justify-content:center;margin-bottom:44px;flex-wrap:wrap;gap:4px}
    .progress-step{display:flex;align-items:center;gap:8px}
    .progress-dot{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#e0dcd5;transition:all .3s;font-size:13px;color:#fff}
    .progress-dot.active{background:var(--dark);transform:scale(1.3)}.progress-dot.done{background:var(--dark)}
    .progress-label{font-size:15px;letter-spacing:.5px;text-transform:uppercase;color:#aaa;transition:all .3s}
    .progress-label.active{color:var(--dark);font-weight:600}.progress-label.done{color:var(--dark)}
    .progress-line{width:52px;height:2px;margin:0 10px;background:#e0dcd5;transition:background .3s}.progress-line.done{background:var(--dark)}
    .content{width:100%;max-width:780px;transition:opacity .4s,transform .4s}.content.fade-out{opacity:0;transform:translateY(12px)}
    .step-title{font-family:var(--font-display);font-size:34px;font-weight:600;margin-bottom:10px}
    .step-desc{font-size:18px;color:var(--gray);margin-bottom:36px}

    /* Services */
    .service-list{display:flex;flex-direction:column;gap:14px;margin-bottom:36px}
    .service-card{display:flex;align-items:center;gap:16px;padding:22px 28px;border:2px solid var(--light-border);border-radius:14px;cursor:pointer;transition:all .2s;background:#fff;text-align:left}
    .service-card:hover{border-color:#ccc}.service-card.selected{border-color:var(--dark);background:var(--light-bg)}
    .service-name{flex:1;font-size:19px;font-weight:500}
    .service-price{font-size:19px;font-weight:600;color:var(--gold)}.service-price.muted{color:#999}
    .custom-desc-box{margin-bottom:32px}.custom-desc-box label{display:block;font-size:14px;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:var(--gray);margin-bottom:10px}
    .custom-desc-box textarea{width:100%;padding:16px 18px;border:2px solid #e0dcd5;border-radius:12px;font-size:17px;font-family:var(--font-body);outline:none;background:#fff;min-height:100px;resize:vertical}
    .custom-desc-box textarea:focus{border-color:var(--gold)}

    /* Calendar */
    .datetime-grid{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:32px}
    .cal-box,.time-box{background:#fff;border-radius:16px;padding:24px;border:1px solid var(--light-border)}
    .cal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    .cal-month{font-family:var(--font-display);font-size:20px;font-weight:600}
    .cal-nav{background:none;border:none;font-size:22px;cursor:pointer;padding:6px 12px;color:var(--dark);border-radius:8px;transition:background .15s}
    .cal-nav:hover{background:rgba(0,0,0,.05)}.cal-nav:disabled{opacity:.3;cursor:default}
    .day-labels{display:grid;grid-template-columns:repeat(7,1fr);justify-items:center;margin-bottom:8px}
    .day-label{font-size:13px;color:#aaa;text-transform:uppercase;letter-spacing:.5px;font-weight:600}
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);justify-items:center;row-gap:4px}
    .cal-day{width:48px;height:48px;border-radius:50%;border:none;background:transparent;font-family:var(--font-body);font-size:16px;cursor:pointer;position:relative;transition:all .2s;color:var(--dark)}
    .cal-day:disabled{color:#ccc;cursor:default}.cal-day.selected{background:var(--dark);color:#fff;font-weight:600}
    .cal-day.today:not(.selected){background:rgba(26,26,26,.08)}
    .cal-day .today-dot{position:absolute;bottom:4px;left:50%;transform:translateX(-50%);width:5px;height:5px;border-radius:50%;background:var(--gold)}

    /* Time */
    .time-box{display:flex;flex-direction:column}
    .time-header{font-family:var(--font-display);font-size:18px;font-weight:600;margin-bottom:18px}
    .time-list{display:flex;flex-direction:column;gap:12px}
    .time-slot{padding:18px 20px;border-radius:12px;border:2px solid var(--light-border);background:#fff;cursor:pointer;font-size:18px;font-weight:500;font-family:var(--font-body);transition:all .15s;text-align:center}
    .time-slot:hover{border-color:#ccc}.time-slot.selected{background:var(--dark);color:#fff;border-color:var(--dark)}
    .time-slot.booked{opacity:.35;cursor:not-allowed;text-decoration:line-through;border-color:#eee}
    .time-placeholder{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:220px}
    .time-placeholder span{font-size:40px;opacity:.2}.time-placeholder p{color:#aaa;margin-top:14px;font-size:17px}
    .loading-slots{text-align:center;padding:20px;color:#aaa;font-size:15px}

    /* Form */
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
    .field{display:flex;flex-direction:column;gap:8px}
    .field label{font-size:14px;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:var(--gray)}
    .field input,.field textarea{padding:16px 18px;border:2px solid #e0dcd5;border-radius:12px;font-size:17px;font-family:var(--font-body);outline:none;background:#fff}
    .field input:focus,.field textarea:focus{border-color:var(--gold)}.field textarea{min-height:100px;resize:vertical}
    .review-strip{display:flex;align-items:center;gap:12px;padding:18px 22px;background:#fff;border:1px solid var(--light-border);border-radius:12px;font-size:17px;font-weight:500;margin-bottom:28px;flex-wrap:wrap}
    .review-strip .dot{color:#ccc}.review-strip .price{color:var(--gold);font-weight:600}
    .wa-notice{display:flex;align-items:center;gap:12px;padding:16px 20px;background:rgba(37,211,102,.08);border:1px solid rgba(37,211,102,.2);border-radius:12px;font-size:16px;color:#666;margin-bottom:28px;line-height:1.5}

    /* Buttons */
    .btn-row{display:flex;gap:14px;margin-top:10px}
    .btn-primary{display:block;width:100%;padding:18px 28px;background:var(--dark);color:#fff;border:none;border-radius:12px;font-size:18px;font-weight:600;letter-spacing:.5px;cursor:pointer;transition:opacity .2s;font-family:var(--font-body)}
    .btn-primary:disabled{opacity:.4;cursor:default}
    .btn-back{padding:18px 28px;background:transparent;color:var(--gray);border:2px solid #e0dcd5;border-radius:12px;font-size:17px;font-weight:500;cursor:pointer;flex-shrink:0;font-family:var(--font-body)}
    .btn-link{background:none;border:none;color:var(--gold);font-size:17px;font-weight:600;cursor:pointer;letter-spacing:.5px;font-family:var(--font-body);margin-top:28px}
    .btn-whatsapp{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;padding:20px 28px;background:var(--wa);color:#fff;border:none;border-radius:14px;font-size:19px;font-weight:600;cursor:pointer;font-family:var(--font-body);transition:background .2s;letter-spacing:.3px;margin-bottom:14px}
    .btn-whatsapp:hover{background:var(--wa-dark)}
    .btn-whatsapp svg{width:26px;height:26px;fill:#fff}

    /* Confirmation */
    .confirm-card{text-align:center;max-width:520px;background:#fff;border-radius:20px;padding:56px 44px;border:1px solid var(--light-border);box-shadow:0 12px 40px rgba(0,0,0,.06);animation:slideUp .6s ease forwards}
    .confirm-title{font-family:var(--font-display);font-size:32px;font-weight:600;margin-bottom:10px}
    .confirm-sub{font-size:17px;color:var(--gray);margin-bottom:36px}
    .summary-box{text-align:left;background:var(--light-bg);border-radius:14px;padding:8px 24px;margin-bottom:32px}
    .summary-row{display:flex;justify-content:space-between;padding:16px 0;border-bottom:1px solid #eee}.summary-row:last-child{border-bottom:none}
    .sum-label{font-size:16px;color:var(--gray)}.sum-value{font-size:17px;font-weight:500;text-align:right;max-width:60%}.sum-value.gold{color:var(--gold);font-weight:700}

    /* PayPal */
    .paypal-section{margin-top:28px;padding:28px;background:var(--light-bg);border-radius:16px;text-align:center}
    .paypal-title{font-weight:600;font-size:18px;margin-bottom:4px}
    .paypal-subtitle{font-size:16px;color:var(--gray);margin-bottom:20px}
    .paypal-btns{max-width:300px;margin:0 auto}
    .divider-row{display:flex;align-items:center;gap:12px;margin:16px 0}
    .divider-line{flex:1;height:1px;background:#e0dcd5}
    .divider-text{font-size:14px;color:#aaa;text-transform:uppercase;letter-spacing:1px}
    .btn-skip{background:none;border:2px solid #e0dcd5;border-radius:12px;padding:14px 28px;font-size:16px;font-weight:500;color:#666;cursor:pointer;font-family:var(--font-body);width:100%;max-width:300px}
    .paid-box{text-align:center;padding:28px;background:#e8f5e9;border-radius:16px;margin-top:24px;color:#2e7d32}

    /* Footer */
    .footer{margin-top:56px;margin-bottom:36px;display:flex;flex-direction:column;align-items:center;gap:12px;font-size:14px;color:#aaa;letter-spacing:.5px}
    .footer-social{display:flex;align-items:center;justify-content:center;gap:14px;margin-top:4px}
    .footer-social a{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,0.06);transition:all .2s;text-decoration:none}
    .footer-social a:hover{background:rgba(0,0,0,0.12);transform:scale(1.1)}
    .footer-social a svg{width:20px;height:20px;fill:#888}
    .footer-text{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}

    @keyframes slideUp{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}

    /* ‚îÄ‚îÄ MOBILE ‚îÄ‚îÄ */
    @media(max-width:680px){
      .hero{padding:40px 16px 36px}
      .hero .brand{font-size:24px}
      .hero .cta-text{font-size:20px}
      .hero .cta-sub{font-size:15px}
      .hero .tagline{font-size:15px;margin-bottom:24px}
      .hero .scroll-hint{padding:12px 24px;font-size:15px}
      .gallery-item{flex:0 0 240px;height:170px}
      .gallery-title{font-size:22px}
      .datetime-grid{grid-template-columns:1fr}
      .form-grid{grid-template-columns:1fr}
      .step-title{font-size:26px}
      .step-desc{font-size:16px;margin-bottom:28px}
      .progress-label{font-size:12px}
      .progress-line{width:28px}
      .confirm-card{padding:40px 24px}
      .confirm-title{font-size:26px}
      .btn-row{flex-direction:column}
      .btn-back{width:100%;text-align:center}
      .cal-box,.time-box{padding:18px}
      .cal-day{width:42px;height:42px;font-size:15px}
      .service-card{padding:18px 20px}
      .service-name,.service-price{font-size:17px}
      .main-area{padding:32px 16px}
      .review-strip{font-size:15px;padding:14px 16px}
      .lightbox-nav{width:42px;height:42px;font-size:24px}
    }
    @media(max-width:380px){
      .hero .brand{font-size:20px}
      .cal-day{width:38px;height:38px;font-size:14px}
    }
    .hidden{display:none!important}
  </style>
</head>
<body>
<div class="app">

  <!-- ‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê -->
  <div class="hero" id="hero-section">
    <div class="logo-mark">‚ú¶</div>
    <h1 class="brand">Studio Fotografico Emiliano Calabritto</h1>
    <p class="tagline">Fotografia d'Autore</p>
    <p class="cta-text">Prenota qui il tuo preventivo gratuito</p>
    <p class="cta-sub">Largo La SanFelice, 4 ¬∑ Montecorvino Rovella, 84096 (SA)</p>
    <button class="scroll-hint" onclick="document.getElementById('booking-section').scrollIntoView({behavior:'smooth'})">Prenota ora ‚Üì</button>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê GALLERY ‚ïê‚ïê‚ïê‚ïê -->
  <section class="gallery-section" id="gallery-section">
    <h2 class="gallery-title">I Nostri Scatti</h2>
    <p class="gallery-sub">Scorri per vedere alcuni dei nostri lavori</p>
    <div class="gallery-track" id="gallery-track">
      <!-- Sostituisci i link con le tue foto: src="nomefoto.jpg" -->
      <div class="gallery-item" onclick="openLightbox(0)"><img src="https://images.unsplash.com/photo-1519741497674-611481863552?w=600&h=400&fit=crop" alt="Matrimonio" loading="lazy"></div>
      <div class="gallery-item" onclick="openLightbox(1)"><img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=600&h=400&fit=crop" alt="Ritratto" loading="lazy"></div>
      <div class="gallery-item" onclick="openLightbox(2)"><img src="https://images.unsplash.com/photo-1609220136736-443140cffec6?w=600&h=400&fit=crop" alt="Famiglia" loading="lazy"></div>
      <div class="gallery-item" onclick="openLightbox(3)"><img src="https://images.unsplash.com/photo-1583939003579-730e3918a45a?w=600&h=400&fit=crop" alt="Evento" loading="lazy"></div>
      <div class="gallery-item" onclick="openLightbox(4)"><img src="https://images.unsplash.com/photo-1511285560929-80b456fea0bc?w=600&h=400&fit=crop" alt="Cerimonia" loading="lazy"></div>
      <div class="gallery-item" onclick="openLightbox(5)"><img src="https://images.unsplash.com/photo-1606216794074-735e91aa2c92?w=600&h=400&fit=crop" alt="Studio" loading="lazy"></div>
    </div>
    <p class="gallery-hint">‚Üê Scorri ‚Üí</p>
  </section>

  <!-- ‚ïê‚ïê‚ïê‚ïê LIGHTBOX ‚ïê‚ïê‚ïê‚ïê -->
  <div class="lightbox" id="lightbox" onclick="if(event.target===this)closeLightbox()">
    <button class="lightbox-close" onclick="closeLightbox()">‚úï</button>
    <button class="lightbox-nav lightbox-prev" onclick="navLightbox(-1)">‚Äπ</button>
    <img id="lightbox-img" src="" alt="">
    <button class="lightbox-nav lightbox-next" onclick="navLightbox(1)">‚Ä∫</button>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê BOOKING ‚ïê‚ïê‚ïê‚ïê -->
  <div id="booking-section" class="main-area">
    <div id="booking-view" style="display:flex;flex-direction:column;align-items:center;width:100%">
      <div class="progress" id="progress"></div>
      <div class="content" id="step-content"></div>
      <footer class="footer">
        <div class="footer-social">
          <a href="https://www.instagram.com/emilianocalabrittoph/" target="_blank" rel="noopener" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg></a>
          <a href="https://www.facebook.com/emiliano.calabritto/" target="_blank" rel="noopener" title="Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
          <a href="https://www.google.com/maps/search/Studio+Fotografico+Emiliano+Calabritto+Largo+La+SanFelice+4+Montecorvino+Rovella" target="_blank" rel="noopener" title="Google Maps"><svg viewBox="0 0 24 24"><path d="M12 0C7.802 0 4 3.403 4 7.602 4 11.8 7.469 16.812 12 24c4.531-7.188 8-12.2 8-16.398C20 3.403 16.199 0 12 0zm0 11a3 3 0 110-6 3 3 0 010 6z"/></svg></a>
        </div>
        <div class="footer-text">
          <span>¬© 2026 Studio Fotografico Emiliano Calabritto</span>
          <span style="color:#ccc">¬∑</span>
          <span>info@calabrittoemiliano.com</span>
        </div>
      </footer>
    </div>
    <div id="confirm-view" class="hidden"></div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚öôÔ∏è  CONFIGURAZIONE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const CONFIG = {
  whatsappNumber: "393331234567",
  paypalClientId: "",

  // Google Sheets ‚Äî URL del tuo Web App (vedi README)
  // Lascia "" se non vuoi usare il sistema prenotazioni
  sheetsApiUrl: "",
};

const SERVICES = [
  { id: "fototessera", name: "Fototessera",           price: 10   },
  { id: "matrimonio",  name: "Consulenza Matrimonio",  price: null },
  { id: "18esimi",     name: "Consulenza 18esimi",     price: null },
  { id: "comunioni",   name: "Consulenza Comunioni",   price: null },
  { id: "altro",       name: "Altro",                  price: null },
];

const TIME_SLOTS = ["17:00", "17:30", "18:00", "18:30"];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const MONTHS=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];
const DAYS_SHORT=["Dom","Lun","Mar","Mer","Gio","Ven","Sab"];
const WA_SVG=`<svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>`;

let state={step:0,serviceId:null,customDesc:"",curMonth:new Date().getMonth(),curYear:new Date().getFullYear(),selectedDay:null,selectedTime:null,client:{name:"",email:"",phone:"",notes:""}};
let bookedSlots={}; // {"2026-03-15":["17:00","17:30"], ...}
const today=new Date();today.setHours(0,0,0,0);

function getSvc(){return SERVICES.find(s=>s.id===state.serviceId)}
function priceLabel(p){return p==null?"Su preventivo":p===0?"Gratuito":`‚Ç¨${p}`}
function formatDate(){if(!state.selectedDay)return"";const d=new Date(state.curYear,state.curMonth,state.selectedDay);return`${DAYS_SHORT[d.getDay()]} ${state.selectedDay} ${MONTHS[state.curMonth]} ${state.curYear}`}
function dateKey(y,m,d){return`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`}

// ‚îÄ‚îÄ GOOGLE SHEETS API ‚îÄ‚îÄ
async function fetchBookedSlots(){
  if(!CONFIG.sheetsApiUrl)return;
  try{
    const r=await fetch(CONFIG.sheetsApiUrl);
    const data=await r.json();
    bookedSlots={};
    data.forEach(b=>{
      if(!bookedSlots[b.date])bookedSlots[b.date]=[];
      bookedSlots[b.date].push(b.time);
    });
  }catch(e){console.warn("Impossibile caricare prenotazioni:",e)}
}

async function saveBooking(dateStr,time,svcName,client,customDesc){
  if(!CONFIG.sheetsApiUrl)return;
  try{
    await fetch(CONFIG.sheetsApiUrl,{
      method:"POST",
      headers:{"Content-Type":"text/plain"},
      body:JSON.stringify({
        date:dateStr,
        time:time,
        service:svcName,
        name:client.name,
        phone:client.phone,
        email:client.email,
        notes:client.notes,
        custom:customDesc
      })
    });
    // Aggiorna localmente
    if(!bookedSlots[dateStr])bookedSlots[dateStr]=[];
    bookedSlots[dateStr].push(time);
  }catch(e){console.warn("Errore salvataggio:",e)}
}

function isBooked(y,m,d,t){
  const k=dateKey(y,m,d);
  return bookedSlots[k]&&bookedSlots[k].includes(t);
}

function buildWhatsAppUrl(){
  const s=getSvc(),c=state.client;
  let m=`‚ú¶ *NUOVA PRENOTAZIONE*\n\nüë§ *Cliente:* ${c.name}\n`;
  if(c.phone)m+=`üìû *Telefono:* ${c.phone}\n`;
  if(c.email)m+=`üìß *Email:* ${c.email}\n`;
  m+=`\nüì∏ *Servizio:* ${s.name}\nüìÖ *Data:* ${formatDate()}\nüïê *Orario:* ${state.selectedTime}\nüí∞ *Prezzo:* ${priceLabel(s.price)}\n`;
  if(state.serviceId==="altro"&&state.customDesc)m+=`\nüìù *Richiesta:* ${state.customDesc}\n`;
  if(c.notes)m+=`\nüí¨ *Note:* ${c.notes}\n`;
  return`https://wa.me/${CONFIG.whatsappNumber}?text=${encodeURIComponent(m)}`;
}

// ‚îÄ‚îÄ LIGHTBOX ‚îÄ‚îÄ
let lbIndex=0;
function getGalleryImages(){return Array.from(document.querySelectorAll('#gallery-track .gallery-item img')).map(i=>i.src)}
function openLightbox(i){lbIndex=i;const imgs=getGalleryImages();document.getElementById('lightbox-img').src=imgs[i];document.getElementById('lightbox').classList.add('open');document.body.style.overflow='hidden'}
function closeLightbox(){document.getElementById('lightbox').classList.remove('open');document.body.style.overflow=''}
function navLightbox(dir){const imgs=getGalleryImages();lbIndex=(lbIndex+dir+imgs.length)%imgs.length;document.getElementById('lightbox-img').src=imgs[lbIndex]}
document.addEventListener('keydown',e=>{if(!document.getElementById('lightbox').classList.contains('open'))return;if(e.key==='Escape')closeLightbox();if(e.key==='ArrowLeft')navLightbox(-1);if(e.key==='ArrowRight')navLightbox(1)});

// ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ
function render(){renderProgress();const el=document.getElementById("step-content");el.classList.add("fade-out");setTimeout(()=>{if(state.step===0)renderStep0(el);else if(state.step===1)renderStep1(el);else renderStep2(el);el.classList.remove("fade-out")},50)}

function renderProgress(){const L=["Servizio","Data e Ora","Dettagli"];let h="";L.forEach((l,i)=>{h+=`<div class="progress-step"><div class="progress-dot ${i<state.step?"done":i===state.step?"active":""}">${i<state.step?"‚úì":""}</div><span class="progress-label ${i<state.step?"done":i===state.step?"active":""}">${l}</span>${i<2?`<div class="progress-line ${i<state.step?"done":""}"></div>`:""}</div>`});document.getElementById("progress").innerHTML=h}

function renderStep0(el){
  let cards=SERVICES.map(s=>`<div class="service-card ${state.serviceId===s.id?"selected":""}" onclick="selectService('${s.id}')"><span class="service-name">${s.name}</span><span class="service-price ${s.price==null?"muted":""}">${priceLabel(s.price)}</span></div>`).join("");
  let cb="";if(state.serviceId==="altro")cb=`<div class="custom-desc-box"><label>Descrivi cosa ti serve *</label><textarea id="custom-desc" placeholder="Descrivi brevemente di cosa hai bisogno‚Ä¶" oninput="state.customDesc=this.value;updBtn0()">${state.customDesc}</textarea></div>`;
  const ok=state.serviceId&&(state.serviceId!=="altro"||state.customDesc.trim());
  el.innerHTML=`<h2 class="step-title">Scegli il Servizio</h2><p class="step-desc">Seleziona il tipo di servizio di cui hai bisogno.</p><div class="service-list">${cards}</div>${cb}<button class="btn-primary" id="b0" ${ok?"":"disabled"} onclick="goStep(1)">Continua</button>`;
}
function selectService(id){state.serviceId=id;if(id!=="altro")state.customDesc="";render()}
function updBtn0(){const b=document.getElementById("b0");if(b)b.disabled=!(state.serviceId&&(state.serviceId!=="altro"||state.customDesc.trim()))}

function renderStep1(el){
  const dim=new Date(state.curYear,state.curMonth+1,0).getDate(),fd=new Date(state.curYear,state.curMonth,1).getDay();
  const canPrev=state.curYear>today.getFullYear()||(state.curYear===today.getFullYear()&&state.curMonth>today.getMonth());
  let dc="";for(let i=0;i<fd;i++)dc+="<div></div>";
  for(let d=1;d<=dim;d++){const dt=new Date(state.curYear,state.curMonth,d),past=dt<today,sun=dt.getDay()===0,dis=past||sun,sel=state.selectedDay===d,td=state.curYear===today.getFullYear()&&state.curMonth===today.getMonth()&&d===today.getDate();
    dc+=`<button class="cal-day ${sel?"selected":""} ${td&&!sel?"today":""}" ${dis?"disabled":""} onclick="selDay(${d})">${d}${td&&!sel?'<span class="today-dot"></span>':""}</button>`}
  let th;
  if(state.selectedDay){
    let slots=TIME_SLOTS.map(t=>{
      const bk=isBooked(state.curYear,state.curMonth,state.selectedDay,t);
      if(bk)return`<div class="time-slot booked">${t} ‚Äî Occupato</div>`;
      return`<button class="time-slot ${state.selectedTime===t?"selected":""}" onclick="selTime('${t}')">${t}</button>`;
    }).join("");
    th=`<p class="time-header">${formatDate()}</p><div class="time-list">${slots}</div>`;
  } else th=`<div class="time-placeholder"><span>‚ó∑</span><p>Seleziona una data</p></div>`;
  el.innerHTML=`<h2 class="step-title">Scegli Data e Orario</h2><p class="step-desc">Disponibile dal luned√¨ al sabato, dalle 17:00 alle 19:00.</p><div class="datetime-grid"><div class="cal-box"><div class="cal-header"><button class="cal-nav" ${canPrev?"":"disabled"} onclick="prevMo()">‚Üê</button><span class="cal-month">${MONTHS[state.curMonth]} ${state.curYear}</span><button class="cal-nav" onclick="nextMo()">‚Üí</button></div><div class="day-labels">${DAYS_SHORT.map(d=>`<div class="day-label">${d}</div>`).join("")}</div><div class="cal-grid">${dc}</div></div><div class="time-box">${th}</div></div><div class="btn-row"><button class="btn-back" onclick="goStep(0)">‚Üê Indietro</button><button class="btn-primary" ${state.selectedDay&&state.selectedTime?"":"disabled"} onclick="goStep(2)">Continua</button></div>`;
}
function selDay(d){state.selectedDay=d;state.selectedTime=null;renderStep1(document.getElementById("step-content"))}
function selTime(t){state.selectedTime=t;renderStep1(document.getElementById("step-content"))}
function prevMo(){if(state.curMonth===0){state.curMonth=11;state.curYear--}else state.curMonth--;state.selectedDay=null;state.selectedTime=null;renderStep1(document.getElementById("step-content"))}
function nextMo(){if(state.curMonth===11){state.curMonth=0;state.curYear++}else state.curMonth++;state.selectedDay=null;state.selectedTime=null;renderStep1(document.getElementById("step-content"))}

function renderStep2(el){
  const s=getSvc(),c=state.client;
  el.innerHTML=`<h2 class="step-title">I Tuoi Dati</h2><p class="step-desc">Inserisci i tuoi dati di contatto.</p>
    <div class="review-strip"><span>${s.name}</span><span class="dot">¬∑</span><span>${formatDate()}</span><span class="dot">¬∑</span><span>${state.selectedTime}</span>${s.price>0?`<span class="dot">¬∑</span><span class="price">‚Ç¨${s.price}</span>`:""}</div>
    <div class="form-grid">
      <div class="field"><label>Nome e Cognome *</label><input id="fn" value="${c.name}" oninput="updCl()" placeholder="Mario Rossi"></div>
      <div class="field"><label>Email</label><input id="fe" type="email" value="${c.email}" oninput="updCl()" placeholder="mario@esempio.com"></div>
      <div class="field"><label>Telefono *</label><input id="fp" type="tel" value="${c.phone}" oninput="updCl()" placeholder="+39 333 000 0000"></div>
      <div class="field"><label>Note aggiuntive</label><textarea id="fno" oninput="updCl()" placeholder="Informazioni utili‚Ä¶">${c.notes}</textarea></div>
    </div>
    <div class="wa-notice"><span style="font-size:22px">üí¨</span><span>Dopo la conferma si aprir√† WhatsApp con il riepilogo da inviare al fotografo</span></div>
    <div class="btn-row"><button class="btn-back" onclick="goStep(1)">‚Üê Indietro</button>
      <button class="btn-primary" id="cb" ${c.name&&c.phone?"":"disabled"} onclick="handleConfirm()">${s.price>0?`Conferma ‚Äî ‚Ç¨${s.price}`:"Conferma Prenotazione"}</button></div>`;
}
function updCl(){state.client.name=document.getElementById("fn").value;state.client.email=document.getElementById("fe").value;state.client.phone=document.getElementById("fp").value;state.client.notes=document.getElementById("fno").value;const b=document.getElementById("cb");if(b)b.disabled=!(state.client.name&&state.client.phone)}
function goStep(n){state.step=n;render();document.getElementById('booking-section').scrollIntoView({behavior:'smooth'})}

async function handleConfirm(){
  const s=getSvc(),c=state.client;if(!c.name||!c.phone)return;

  // Salva prenotazione su Google Sheets
  const dk=dateKey(state.curYear,state.curMonth,state.selectedDay);
  await saveBooking(dk,state.selectedTime,s.name,c,state.serviceId==="altro"?state.customDesc:"");

  document.getElementById("hero-section").classList.add("hidden");
  document.getElementById("gallery-section").classList.add("hidden");
  document.getElementById("booking-view").classList.add("hidden");
  const cv=document.getElementById("confirm-view");cv.classList.remove("hidden");
  let rows=[["Servizio",s.name],["Data",formatDate()],["Orario",state.selectedTime],["Cliente",c.name],["Telefono",c.phone]];
  if(c.email)rows.push(["Email",c.email]);
  if(state.serviceId==="altro"&&state.customDesc)rows.push(["Richiesta",state.customDesc]);
  if(c.notes)rows.push(["Note",c.notes]);
  let sh=rows.map(([l,v])=>`<div class="summary-row"><span class="sum-label">${l}</span><span class="sum-value">${v}</span></div>`).join("");
  sh+=`<div class="summary-row"><span class="sum-label">Prezzo</span><span class="sum-value gold">${priceLabel(s.price)}</span></div>`;
  cv.innerHTML=`<div class="confirm-card"><div style="font-size:52px;margin-bottom:16px">‚ú¶</div>
    <h2 class="confirm-title">Prenotazione Pronta!</h2>
    <p class="confirm-sub">Invia il riepilogo al fotografo tramite WhatsApp per confermare</p>
    <div class="summary-box">${sh}</div>
    <button class="btn-whatsapp" onclick="window.open('${buildWhatsAppUrl()}','_blank')">${WA_SVG} Invia su WhatsApp</button>
    <div id="paypal-area"></div>
    <button class="btn-link" onclick="resetAll()">Prenota un altro appuntamento</button></div>`;
  if(s.price>0&&CONFIG.paypalClientId)loadPayPal(s);
  window.scrollTo({top:0,behavior:'smooth'});
}

function loadPayPal(s){
  const a=document.getElementById("paypal-area");
  a.innerHTML=`<div class="paypal-section"><p class="paypal-title">Paga ora (opzionale)</p><p class="paypal-subtitle">Puoi pagare con PayPal o pagare in studio</p><div class="paypal-btns" id="pp-btns"></div><div class="divider-row"><div class="divider-line"></div><span class="divider-text">oppure</span><div class="divider-line"></div></div><button class="btn-skip" onclick="document.getElementById('paypal-area').innerHTML=''">Pagher√≤ in studio</button></div>`;
  const sc=document.createElement("script");sc.src=`https://www.paypal.com/sdk/js?client-id=${CONFIG.paypalClientId}&currency=EUR`;
  sc.onload=()=>{paypal.Buttons({style:{layout:"vertical",shape:"rect",label:"pay",height:45},createOrder:(d,ac)=>ac.order.create({purchase_units:[{amount:{value:String(s.price),currency_code:"EUR"},description:`${s.name} ‚Äî ${formatDate()} ${state.selectedTime}`}]}),onApprove:async(d,ac)=>{await ac.order.capture();a.innerHTML=`<div class="paid-box"><div style="font-size:28px">‚úì</div><p style="font-weight:600;margin:8px 0 0">Pagamento ricevuto</p><p style="font-size:13px;margin:4px 0 0;color:#2e7d32">Grazie!</p></div>`},onError:()=>{a.querySelector(".paypal-subtitle").textContent="Errore. Riprova o paga in studio.";a.querySelector(".paypal-subtitle").style.color="#c0392b"}}).render("#pp-btns")};
  document.head.appendChild(sc);
}

function resetAll(){state={step:0,serviceId:null,customDesc:"",curMonth:new Date().getMonth(),curYear:new Date().getFullYear(),selectedDay:null,selectedTime:null,client:{name:"",email:"",phone:"",notes:""}};document.getElementById("confirm-view").classList.add("hidden");document.getElementById("hero-section").classList.remove("hidden");document.getElementById("gallery-section").classList.remove("hidden");document.getElementById("booking-view").classList.remove("hidden");render();window.scrollTo({top:0,behavior:'smooth'})}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
fetchBookedSlots().then(()=>render());
</script>
</body>
</html>
